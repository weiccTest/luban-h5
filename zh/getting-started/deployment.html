<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>éƒ¨ç½² | é²ç­H5</title>
    <meta name="description" content="">
    <link rel="preload" href="/luban-h5/assets/css/0.styles.5a6cf3a3.css" as="style"><link rel="preload" href="/luban-h5/assets/js/app.9db938e8.js" as="script"><link rel="preload" href="/luban-h5/assets/js/2.45c7802b.js" as="script"><link rel="preload" href="/luban-h5/assets/js/16.a76b2f4d.js" as="script"><link rel="prefetch" href="/luban-h5/assets/js/10.3ff9057e.js"><link rel="prefetch" href="/luban-h5/assets/js/11.b488c8df.js"><link rel="prefetch" href="/luban-h5/assets/js/12.7d23ae34.js"><link rel="prefetch" href="/luban-h5/assets/js/13.b908ccc7.js"><link rel="prefetch" href="/luban-h5/assets/js/14.cd3fe85c.js"><link rel="prefetch" href="/luban-h5/assets/js/15.a1fab954.js"><link rel="prefetch" href="/luban-h5/assets/js/17.222f3d31.js"><link rel="prefetch" href="/luban-h5/assets/js/18.1aa0b689.js"><link rel="prefetch" href="/luban-h5/assets/js/19.a29a38e5.js"><link rel="prefetch" href="/luban-h5/assets/js/20.9d8b5a86.js"><link rel="prefetch" href="/luban-h5/assets/js/21.d23eeef6.js"><link rel="prefetch" href="/luban-h5/assets/js/22.c6d921c4.js"><link rel="prefetch" href="/luban-h5/assets/js/23.527d6190.js"><link rel="prefetch" href="/luban-h5/assets/js/24.e618db77.js"><link rel="prefetch" href="/luban-h5/assets/js/3.7e100d82.js"><link rel="prefetch" href="/luban-h5/assets/js/4.07c2a1da.js"><link rel="prefetch" href="/luban-h5/assets/js/5.f140c2c4.js"><link rel="prefetch" href="/luban-h5/assets/js/6.5254a33f.js"><link rel="prefetch" href="/luban-h5/assets/js/7.78616a91.js"><link rel="prefetch" href="/luban-h5/assets/js/8.9f4fccf7.js"><link rel="prefetch" href="/luban-h5/assets/js/9.20fcbeb4.js">
    <link rel="stylesheet" href="/luban-h5/assets/css/0.styles.5a6cf3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/luban-h5/zh/" class="home-link router-link-active"><!----> <span class="site-name">é²ç­H5</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://h5.luban-h5.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  é¦–é¡µ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/ly525/luban-h5/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/luban-h5/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/luban-h5/zh/getting-started/deployment.html" class="nav-link router-link-exact-active router-link-active">ç®€ä½“ä¸­æ–‡</a></li></ul></div></div> <a href="https://github.com/ly525/luban-h5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://h5.luban-h5.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  é¦–é¡µ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/ly525/luban-h5/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/luban-h5/" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/luban-h5/zh/getting-started/deployment.html" class="nav-link router-link-exact-active router-link-active">ç®€ä½“ä¸­æ–‡</a></li></ul></div></div> <a href="https://github.com/ly525/luban-h5" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ğŸš€ Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/luban-h5/zh/getting-started/introduction.html" class="sidebar-link">/zh/getting-started/introduction.html</a></li><li><a href="/luban-h5/zh/getting-started/features.html" class="sidebar-link">Features</a></li><li><a href="/luban-h5/zh/getting-started/quick-start.html" class="sidebar-link">å¿«é€Ÿå¼€å§‹</a></li><li><a href="/luban-h5/zh/getting-started/deployment.html" class="active sidebar-link">éƒ¨ç½²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/luban-h5/zh/getting-started/deployment.html#é˜¿é‡Œäº‘-è…¾è®¯äº‘-digital-ocean" class="sidebar-link">é˜¿é‡Œäº‘/è…¾è®¯äº‘/Digital Ocean</a></li><li class="sidebar-sub-header"><a href="/luban-h5/zh/getting-started/deployment.html#docker-éƒ¨ç½²" class="sidebar-link">Docker éƒ¨ç½²</a></li><li class="sidebar-sub-header"><a href="/luban-h5/zh/getting-started/deployment.html#heroku" class="sidebar-link">Heroku</a></li></ul></li><li><a href="/luban-h5/zh/getting-started/discussion.html" class="sidebar-link">ç¤¾åŒºä¸äº¤æµç¾¤</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ğŸ’¡å®ç°åŸç†</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/luban-h5/zh/implementation/code-structure.html" class="sidebar-link">ä»£ç ç›®å½•è¯´æ˜</a></li><li><a href="/luban-h5/zh/implementation/form-submit.html" class="sidebar-link">è¡¨å•æäº¤</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ğŸ”Œ Local plugins</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="header-anchor">#</a> éƒ¨ç½²</h1> <blockquote><p>æ¬¢è¿å¤§å®¶åˆ°<a href="https://support.qq.com/products/93432/" target="_blank" rel="noopener noreferrer">é²ç­H5-ç¤¾åŒº<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº¤æµï¼Œåœ¨è¿™é‡Œå¯ä»¥æé—®ã€åé¦ˆæ„è§å’Œå»ºè®®ï¼Œä¸ä½œè€…ç›´æ¥äº’åŠ¨</p></blockquote> <h2 id="é˜¿é‡Œäº‘-è…¾è®¯äº‘-digital-ocean"><a href="#é˜¿é‡Œäº‘-è…¾è®¯äº‘-digital-ocean" class="header-anchor">#</a> é˜¿é‡Œäº‘/è…¾è®¯äº‘/Digital Ocean</h2> <blockquote><p>ä»¥ Centos ä¸ºä¾‹ï¼ŒUbuntuç­‰å…¶å®ƒå‘è¡Œç‰ˆï¼Œè¯·è‡ªè¡Œè°ƒæ•´</p></blockquote> <ol><li>é¢„å®‰è£…ï¼š</li></ol> <ul><li><p>é¦–å…ˆéœ€è¦å®‰è£…ä¸€äº›åŸºç¡€çš„è½¯ä»¶åŒ…ï¼Œè¯·è‡ªè¡Œå®‰è£…ï¼ˆå…·ä½“å‚ç…§å…¶å®˜ç½‘æ–‡æ¡£ï¼‰</p> <ul><li>node</li> <li>npm</li> <li>nginx</li> <li>yarn</li> <li>pm2</li></ul></li> <li><p>1.2 ä»¥ä¸‹è„šæœ¬ä»…ä¾›å‚è€ƒ</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># install yarn</span>
<span class="token function">curl</span> --silent --location https://dl.yarnpkg.com/rpm/yarn.repo <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/yum.repos.d/yarn.repo
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token function">yarn</span> -y
<span class="token comment"># install nginx</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> nginx -y
<span class="token comment"># install pm2</span>
<span class="token function">npm</span> <span class="token function">install</span> pm2 -g
<span class="token comment"># pm2 examples</span>
<span class="token comment"># pm2 start server.js</span>
<span class="token comment"># pm2 stop server</span>
<span class="token comment"># pm2 restart server</span>
<span class="token comment"># pm2 stop all</span>
</code></pre></div><p>nginx é…ç½®æ–‡ä»¶ demo</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">listen</span> <span class="token number">443</span><span class="token punctuation">;</span>
  <span class="token keyword">server_name</span> your_domain<span class="token punctuation">;</span>
  <span class="token keyword">client_body_buffer_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">client_max_body_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_buffer_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_buffers</span> <span class="token number">32</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">proxy_busy_buffers_size</span> <span class="token number">20</span>M<span class="token punctuation">;</span>
  <span class="token keyword">ssl</span> on<span class="token punctuation">;</span>
  <span class="token keyword">ssl_certificate</span> cert<span class="token operator">/</span>your<span class="token operator">-</span><span class="token keyword">https</span><span class="token punctuation">.</span>pem<span class="token punctuation">;</span>
  <span class="token keyword">ssl_certificate_key</span> cert<span class="token operator">/</span>your<span class="token operator">-</span><span class="token keyword">https</span><span class="token punctuation">.</span>key<span class="token punctuation">;</span>
  <span class="token keyword">ssl_session_timeout</span> <span class="token number">5</span>s<span class="token punctuation">;</span>
  <span class="token keyword">ssl_ciphers</span> ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES128<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA256<span class="token punctuation">:</span>ECDHE<span class="token punctuation">:</span>ECDH<span class="token punctuation">:</span>AES<span class="token punctuation">:</span>HIGH<span class="token punctuation">:</span><span class="token operator">!</span>NULL<span class="token punctuation">:</span><span class="token operator">!</span>aNULL<span class="token punctuation">:</span><span class="token operator">!</span>MD5<span class="token punctuation">:</span><span class="token operator">!</span>ADH<span class="token punctuation">:</span><span class="token operator">!</span>RC4<span class="token punctuation">;</span>
  <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token punctuation">.</span><span class="token number">1</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>
  <span class="token keyword">gzip</span> on<span class="token punctuation">;</span>
  <span class="token keyword">gzip_min_length</span> <span class="token number">1</span>k<span class="token punctuation">;</span>
  <span class="token keyword">gzip_buffers</span> <span class="token number">4</span> <span class="token number">16</span>k<span class="token punctuation">;</span>
  <span class="token keyword">gzip_disable</span> <span class="token string">&quot;MSIE [1-6]\.&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">gzip_comp_level</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token keyword">gzip_types</span> image<span class="token operator">/</span>png application<span class="token operator">/</span>json text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml text<span class="token operator">/</span>javascript application<span class="token operator">/</span>javascript<span class="token punctuation">;</span>
  <span class="token comment"># TODO è¿™è¾¹çš„ psd-filesã€engine-assetsã€third-libs å¼€å‘çš„æ—¶å€™ï¼Œå¯ä»¥èµ° proxy_pass</span>
  <span class="token comment"># ç”Ÿäº§ç¯å¢ƒçš„æ—¶å€™ï¼Œæœ€å¥½èµ°å¦å¤–çš„ locationï¼Œç›´æ¥è®© nginx è®¿é—®é™æ€æ–‡ä»¶</span>
  <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">^</span><span class="token operator">/</span><span class="token punctuation">(</span>upload<span class="token operator">|</span>content<span class="token operator">-</span>manager<span class="token operator">|</span>users<span class="token operator">-</span>permissions<span class="token operator">|</span>works<span class="token operator">|</span>admin<span class="token operator">|</span>psd<span class="token operator">-</span>files<span class="token operator">|</span>workforms<span class="token operator">|</span>third<span class="token operator">-</span>libs<span class="token operator">|</span>engine<span class="token operator">-</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">1337</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token keyword">root</span> <span class="token operator">/</span>home<span class="token operator">/</span>centos<span class="token operator">/</span>codebase<span class="token operator">/</span>luban<span class="token operator">/</span>luban<span class="token operator">-</span>h5<span class="token operator">-</span>dist<span class="token operator">/</span>front<span class="token operator">-</span>end<span class="token operator">/</span><span class="token punctuation">;</span>
    <span class="token comment">#try_files $uri $uri/ /index.html;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="æœ¬åœ°æ‰§è¡Œï¼š"><a href="#æœ¬åœ°æ‰§è¡Œï¼š" class="header-anchor">#</a> æœ¬åœ°æ‰§è¡Œï¼š</h4> <p>è¯·å…ˆæå‰è°ƒç ”ï¼šflightplan
åœ¨é¡¹ç›®æ ¹ç›®å½•ä½œå¦‚ä¸‹æ“ä½œï¼š</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> flightplan // éƒ¨ç½²è„šæœ¬ï¼Œå®˜æ–¹é“¾æ¥
<span class="token function">npm</span> run deploy:ecs // äº‘æœåŠ¡å™¨ <span class="token punctuation">(</span>Elastic Compute Service, ç®€ç§° ECS<span class="token punctuation">)</span>
</code></pre></div><p>æœ¬åœ°éƒ¨ç½²è„šæœ¬</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> plan <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'flightplan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// configuration</span>
local_dist_dir <span class="token operator">=</span> <span class="token string">'./'</span><span class="token punctuation">;</span> <span class="token comment">// root path for luban-h5</span>
remote_project_dir <span class="token operator">=</span> <span class="token string">'~/codebase/luban/luban-h5'</span><span class="token punctuation">;</span> <span class="token comment">// root path for luban-h5 on server</span>
remote_project_api_dir <span class="token operator">=</span> <span class="token string">'~/codebase/luban/luban-h5/back-end/h5-api'</span><span class="token punctuation">;</span> <span class="token comment">// api root path for luban-h5 on server</span>
<span class="token comment">// production server config</span>
plan<span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span><span class="token string">'production'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  host<span class="token punctuation">:</span> <span class="token string">'your host ip'</span><span class="token punctuation">,</span> <span class="token comment">// your server ip</span>
  username<span class="token punctuation">:</span> <span class="token string">'centos'</span><span class="token punctuation">,</span> <span class="token comment">// your server username</span>
  <span class="token comment">// æ›´æ–°ä¸ºç»å¯¹è·¯å¾„</span>
  privateKey<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>os<span class="token punctuation">.</span>homedir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/.ssh/id_rsa</span><span class="token template-punctuation string">`</span></span> <span class="token comment">// your privateKey to rsync files</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 1. setup folders
 * 2. sync files
 * 3. install dependencies
 * 4. (re)start api service
 * 5. soft link nginx conf
 *
 * 1. åˆ›å»ºåŒæ­¥æ–‡ä»¶ä»¶
 * 2. åŒæ­¥æœ¬åœ°åœ¨ git ä¸­çš„æ–‡ä»¶ï¼ˆä½ ä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯git cloneï¼‰
 * 3. åœ¨ h5-api ç›®å½•å®‰è£…ä¾èµ–
 * 4. ä½¿ç”¨pm2 é‡å¯æœåŠ¡
 * 5. ç»™ nginx æ–‡ä»¶åšä¸€ä¸ªè½¯ä»¶é“¾æ¥
 *
 */</span>
<span class="token comment">// init remove server path</span>
<span class="token comment">// åœ¨ç¬¬ä¸€æ­¥çš„æ—¶å€™ï¼Œéœ€è¦æ‰“å¼€è¿™ä¸€é¡¹ï¼šåˆå§‹åŒ–æœåŠ¡å™¨ï¼Œç°åœ¨è¿˜ä¸å®Œæ•´ï¼Œéœ€è¦è¡¥å……</span>
<span class="token comment">// plan.remote(remote =&gt; {</span>
<span class="token comment">//   // remove.exec(`mkdir -p ${remote_project_dir}`)</span>
<span class="token comment">//   remove.sudo(`yum install nginx -y`)</span>
<span class="token comment">//   remote.with(`mkdir -p ${remote_project_dir}`, () =&gt; {</span>
<span class="token comment">//     // remote.log('Install dependencies');</span>
<span class="token comment">//     // remote.exec('yarn');</span>
<span class="token comment">//     remote.exec('pwd');</span>
<span class="token comment">//   });</span>
<span class="token comment">// });</span>
<span class="token comment">// run commands on localhost</span>
plan<span class="token punctuation">.</span><span class="token function">local</span><span class="token punctuation">(</span><span class="token parameter">local</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// local.log('=&gt; Run build');</span>
  <span class="token comment">// local.exec('npm run build');</span>
  <span class="token comment">// local.log('=&gt; Build finish');</span>
  local<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'=&gt; Copy files to remote hosts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// TODO reference: https://github.com/pstadler/flightplan/issues/142</span>
  local<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>local_dist_dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// const filesToCopy = local.exec('find . -type f', { silent: true })</span>
    <span class="token keyword">const</span> filesToCopy <span class="token operator">=</span> local<span class="token punctuation">.</span><span class="token function">git</span><span class="token punctuation">(</span><span class="token string">'ls-files'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>silent<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// get list of files under version control</span>
    local<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>filesToCopy<span class="token punctuation">,</span> remote_project_dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
    local<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'=&gt; Copy finish'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// run commands on the target's remote hosts</span>
plan<span class="token punctuation">.</span><span class="token function">remote</span><span class="token punctuation">(</span><span class="token parameter">remote</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  remote<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cd </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>remote_project_api_dir<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    remote<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Install dependencies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'yarn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    remote<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'pm2 restart server'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="ä¸­é—´å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼š"><a href="#ä¸­é—´å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼š" class="header-anchor">#</a> ä¸­é—´å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼š</h4> <ol><li><p><code>Cannot parse privateKey: Unsupported key format</code></p> <p>è§£å†³æ–¹æ¡ˆè¯·å‚ç…§ï¼š<a href="https://stackoverflow.com/questions/53400628/cannot-parse-privatekey-unsupported-key-format" target="_blank" rel="noopener noreferrer">Cannot parse privateKey: Unsupported key format<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ol> <h2 id="docker-éƒ¨ç½²"><a href="#docker-éƒ¨ç½²" class="header-anchor">#</a> Docker éƒ¨ç½²</h2> <blockquote><p>ä»¥ä¸‹æ–¹æ¡ˆæ¥è‡ªï¼š<a href="https://github.com/yi-ge/luban-h5#docker-%E9%83%A8%E7%BD%B2" target="_blank" rel="noopener noreferrer">https://github.com/yi-ge/luban-h5#docker-%E9%83%A8%E7%BD%B2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œéå¸¸éå¸¸æ„Ÿè°¢ã€‚
ä½†ä»…ä¾›å‚è€ƒï¼Œæ­¤æ–¹æ¡ˆä¸æ˜¯é²ç­çš„å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆ</p> <p>é²ç­å†³å®šæš‚æ—¶ä¸æŒ‰ç…§è¿™ç§æ–¹æ¡ˆæ¥åšï¼Œå¯ä»¥å…ˆä½¿ç”¨ä¸Šé¢éƒ¨ç½²è„šæœ¬æ¥å‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿›è¡Œéƒ¨ç½²ã€‚</p> <p>é²ç­åæœŸè€ƒè™‘å‡ºä¸€ä¸ªç®€å•ç‰ˆæœ¬docker imageçš„éƒ¨ç½²æ–¹æ¡ˆï¼Œç›´æ¥æ‹‰é•œåƒï¼Œåœ¨æœåŠ¡å™¨ç«¯å°±èƒ½ç›´æ¥è·‘èµ·æ¥ã€‚</p></blockquote> <ol><li>è¯·ç¡®ä¿æ‚¨çš„<code>80</code>ç«¯å£å’Œ<code>443</code>ç«¯å£å‡æ‰“å¼€ï¼Œå¦‚æœå·²ç»é…ç½®äº†å…¶å®ƒé¡¹ç›®ï¼Œè¯·è¿›è¡Œæ‰‹å·¥è°ƒæ•´ã€‚</li> <li>ä¿®æ”¹<code>yourdomain.tld</code>ä¸ºæ‚¨çš„å‰ç«¯åŸŸåå¹¶è§£æåˆ°æœåŠ¡å™¨ã€‚</li> <li>ä¿®æ”¹<code>api.yourdomain.tld</code>ä¸ºæ‚¨çš„åç«¯åŸŸåå¹¶è§£æåˆ°æœåŠ¡å™¨ã€‚</li> <li>ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Clone luban-h5</span>
<span class="token function">git</span> clone https://github.com/ly525/luban-h5.git
<span class="token builtin class-name">cd</span> luban-h5
<span class="token comment"># Install require package</span>
docker run --rm -v <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>:/root -w /root/back-end/h5-api node:12.8.1 <span class="token function">bash</span> -c <span class="token string">&quot;yarn &amp;&amp; NODE_ENV=production yarn build&quot;</span>
docker run --rm -v <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>:/root -w /root/front-end/h5 <span class="token punctuation">\</span>
    --env <span class="token string">&quot;PUBLIC_PATH=/&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;PROD_API_ORIGIN=api.yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
    node:12.8.1 <span class="token function">bash</span> -c <span class="token string">&quot;yarn &amp;&amp; NODE_ENV=production yarn build &amp;&amp; node build/engine.webpack.js&quot;</span>
<span class="token comment"># Start back-end</span>
docker run --detach <span class="token punctuation">\</span>
    --name nginx-proxy <span class="token punctuation">\</span>
    --publish <span class="token number">80</span>:80 <span class="token punctuation">\</span>
    --publish <span class="token number">443</span>:443 <span class="token punctuation">\</span>
    --volume /etc/nginx/certs <span class="token punctuation">\</span>
    --volume /etc/nginx/vhost.d <span class="token punctuation">\</span>
    --volume /usr/share/nginx/html <span class="token punctuation">\</span>
    --volume /var/run/docker.sock:/tmp/docker.sock:ro <span class="token punctuation">\</span>
    jwilder/nginx-proxy
docker run --detach <span class="token punctuation">\</span>
    --name nginx-proxy-letsencrypt <span class="token punctuation">\</span>
    --volumes-from nginx-proxy <span class="token punctuation">\</span>
    --volume /var/run/docker.sock:/var/run/docker.sock:ro <span class="token punctuation">\</span>
    jrcs/letsencrypt-nginx-proxy-companion
docker run -itd -m 512m <span class="token punctuation">\</span>
    --restart<span class="token operator">=</span>always <span class="token punctuation">\</span>
    --name luban-h5-front <span class="token punctuation">\</span>
    -v <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>/front-end/h5/dist:/usr/share/nginx/html <span class="token punctuation">\</span>
    --env <span class="token string">&quot;NODE_ENV=production&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;VIRTUAL_HOST=yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;LETSENCRYPT_HOST=yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;PROD_API_ORIGIN=api.yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
    nginx
<span class="token comment"># Start font-end</span>
docker run -itd -m 1024m <span class="token punctuation">\</span>
    --name luban-h5-api <span class="token punctuation">\</span>
    --restart<span class="token operator">=</span>always <span class="token punctuation">\</span>
    -v <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>:/root -w /root/back-end/h5-api <span class="token punctuation">\</span>
    -p <span class="token number">1337</span>:1337 <span class="token punctuation">\</span>
    --env <span class="token string">&quot;NODE_ENV=production&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;VIRTUAL_PORT=1337&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;VIRTUAL_HOST=api.yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
    --env <span class="token string">&quot;LETSENCRYPT_HOST=api.yourdomain.tld&quot;</span> <span class="token punctuation">\</span>
   --restart<span class="token operator">=</span>always node:12.8.1 <span class="token punctuation">\</span>
   <span class="token function">yarn</span> start
</code></pre></div><p>ç¨ç­‰ç‰‡åˆ»ï¼Œè®¿é—®<code>https://ä½ çš„åŸŸå</code>ï¼Œéƒ¨ç½²å®Œæˆã€‚</p> <p>å…³äºNginxã€SSLçš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion" target="_blank" rel="noopener noreferrer">https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr> <p>docker è‡ªæˆ‘å­¦ä¹ ï¼Œè¯·å¿½ç•¥</p> <div class="language-bash extra-class"><pre class="language-bash"><code>docker --rm
	ç›¸å½“äºï¼š
	<span class="token number">1</span>. docker run hello-world<span class="token punctuation">(</span>hello-worldä¸ºimage-name<span class="token punctuation">)</span>
	<span class="token number">2</span>. docker <span class="token function">rm</span> hello-world-container-id<span class="token punctuation">(</span>é€šè¿‡ docker <span class="token function">ps</span> -a æŸ¥çœ‹<span class="token punctuation">)</span>
	åœ¨Dockerå®¹å™¨é€€å‡ºæ—¶ï¼Œé»˜è®¤å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶ç³»ç»Ÿä»ç„¶è¢«ä¿ç•™ï¼Œä»¥æ–¹ä¾¿è°ƒè¯•å¹¶ä¿ç•™ç”¨æˆ·æ•°æ®ã€‚
	ä½†æ˜¯ï¼Œå¯¹äºforegroundå®¹å™¨ï¼Œç”±äºå…¶åªæ˜¯åœ¨å¼€å‘è°ƒè¯•è¿‡ç¨‹ä¸­çŸ­æœŸè¿è¡Œï¼Œå…¶ç”¨æˆ·æ•°æ®å¹¶æ— ä¿ç•™çš„å¿…è¦ï¼Œå› è€Œå¯ä»¥åœ¨å®¹å™¨å¯åŠ¨æ—¶è®¾ç½®--rmé€‰é¡¹ï¼Œè¿™æ ·åœ¨å®¹å™¨é€€å‡ºæ—¶å°±èƒ½å¤Ÿè‡ªåŠ¨æ¸…ç†å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š
	docker run --rm bba-208ç­‰ä»·äºdocker run --rm<span class="token operator">=</span>true bba-208ã€‚
	æ˜¾ç„¶ï¼Œ--rmé€‰é¡¹ä¸èƒ½ä¸-dåŒæ—¶ä½¿ç”¨ï¼Œå³åªèƒ½è‡ªåŠ¨æ¸…ç†foregroundå®¹å™¨ï¼Œä¸èƒ½è‡ªåŠ¨æ¸…ç†detachedå®¹å™¨
	æ³¨æ„ï¼Œ--rmé€‰é¡¹ä¹Ÿä¼šæ¸…ç†å®¹å™¨çš„åŒ¿ådata volumesã€‚
	æ‰€ä»¥ï¼Œæ‰§è¡Œdocker runå‘½ä»¤å¸¦--rmå‘½ä»¤é€‰é¡¹ï¼Œç­‰ä»·äºåœ¨å®¹å™¨é€€å‡ºåï¼Œæ‰§è¡Œdocker <span class="token function">rm</span> -vã€‚
Dockerå‘½ä»¤è¯¦è§£ï¼ˆrunç¯‡ï¼‰
	å‘½ä»¤æ ¼å¼ï¼šdocker run <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> IMAGE <span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span> <span class="token punctuation">[</span>ARG<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
	Usage: Run a <span class="token builtin class-name">command</span> <span class="token keyword">in</span> a new container
	ä¸­æ–‡æ„æ€ä¸ºï¼šé€šè¿‡runå‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼ˆcontainerï¼‰
	å¸¸ç”¨é€‰é¡¹è¯´æ˜
	-d, --detach<span class="token operator">=</span>falseï¼Œ æŒ‡å®šå®¹å™¨è¿è¡Œäºå‰å°è¿˜æ˜¯åå°ï¼Œé»˜è®¤ä¸ºfalse
	-i, --interactive<span class="token operator">=</span>falseï¼Œ æ‰“å¼€STDINï¼Œç”¨äºæ§åˆ¶å°äº¤äº’
	-t, --tty<span class="token operator">=</span>falseï¼Œ åˆ†é…ttyè®¾å¤‡ï¼Œè¯¥å¯ä»¥æ”¯æŒç»ˆç«¯ç™»å½•ï¼Œé»˜è®¤ä¸ºfalse
	-u, --user<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„ç”¨æˆ·
	-a, --attach<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ ç™»å½•å®¹å™¨ï¼ˆå¿…é¡»æ˜¯ä»¥docker run -då¯åŠ¨çš„å®¹å™¨ï¼‰
	-w, --workdir<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„å·¥ä½œç›®å½•
	-c, --cpu-shares<span class="token operator">=</span><span class="token number">0</span>ï¼Œ è®¾ç½®å®¹å™¨CPUæƒé‡ï¼Œåœ¨CPUå…±äº«åœºæ™¯ä½¿ç”¨
	-e, --env<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œå®¹å™¨ä¸­å¯ä»¥ä½¿ç”¨è¯¥ç¯å¢ƒå˜é‡
	-m, --memory<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„å†…å­˜ä¸Šé™
	-P, --publish-all<span class="token operator">=</span>falseï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£
	-p, --publish<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£
	-h, --hostname<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„ä¸»æœºå
	-v, --volume<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•
	--volumes-from<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ ç»™å®¹å™¨æŒ‚è½½å…¶ä»–å®¹å™¨ä¸Šçš„å·ï¼ŒæŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•
	--cap-add<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æ·»åŠ æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼šhttp://linux.die.net/man/7/capabilities
	--cap-drop<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ åˆ é™¤æƒé™ï¼Œæƒé™æ¸…å•è¯¦è§ï¼šhttp://linux.die.net/man/7/capabilities
	--cidfile<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ è¿è¡Œå®¹å™¨åï¼Œåœ¨æŒ‡å®šæ–‡ä»¶ä¸­å†™å…¥å®¹å™¨PIDå€¼ï¼Œä¸€ç§å…¸å‹çš„ç›‘æ§ç³»ç»Ÿç”¨æ³•
	--cpuset<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ è®¾ç½®å®¹å™¨å¯ä»¥ä½¿ç”¨å“ªäº›CPUï¼Œæ­¤å‚æ•°å¯ä»¥ç”¨æ¥å®¹å™¨ç‹¬å CPU
	--device<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æ·»åŠ ä¸»æœºè®¾å¤‡ç»™å®¹å™¨ï¼Œç›¸å½“äºè®¾å¤‡ç›´é€š
	--dns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„dnsæœåŠ¡å™¨
	--dns-search<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„dnsæœç´¢åŸŸåï¼Œå†™å…¥åˆ°å®¹å™¨çš„/etc/resolv.confæ–‡ä»¶
	--entrypoint<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ è¦†ç›–imageçš„å…¥å£ç‚¹
	--env-file<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªç¯å¢ƒå˜é‡
	--expose<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨æš´éœ²çš„ç«¯å£ï¼Œå³ä¿®æ”¹é•œåƒçš„æš´éœ²ç«¯å£
	--link<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨é—´çš„å…³è”ï¼Œä½¿ç”¨å…¶ä»–å®¹å™¨çš„IPã€envç­‰ä¿¡æ¯
	--lxc-conf<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ï¼Œ æŒ‡å®šå®¹å™¨çš„é…ç½®æ–‡ä»¶ï¼Œåªæœ‰åœ¨æŒ‡å®š--exec-driver<span class="token operator">=</span>lxcæ—¶ä½¿ç”¨
	--name<span class="token operator">=</span><span class="token string">&quot;&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨åå­—ï¼Œåç»­å¯ä»¥é€šè¿‡åå­—è¿›è¡Œå®¹å™¨ç®¡ç†ï¼Œlinksç‰¹æ€§éœ€è¦ä½¿ç”¨åå­—
	--net<span class="token operator">=</span><span class="token string">&quot;bridge&quot;</span>ï¼Œ å®¹å™¨ç½‘ç»œè®¾ç½®:
	bridge ä½¿ç”¨docker daemonæŒ‡å®šçš„ç½‘æ¡¥
	<span class="token function">host</span> //å®¹å™¨ä½¿ç”¨ä¸»æœºçš„ç½‘ç»œ
	container:NAME_or_ID <span class="token operator">&gt;</span>//ä½¿ç”¨å…¶ä»–å®¹å™¨çš„ç½‘è·¯ï¼Œå…±äº«IPå’ŒPORTç­‰ç½‘ç»œèµ„æº
	none å®¹å™¨ä½¿ç”¨è‡ªå·±çš„ç½‘ç»œï¼ˆç±»ä¼¼--net<span class="token operator">=</span>bridgeï¼‰ï¼Œä½†æ˜¯ä¸è¿›è¡Œé…ç½®
	--privileged<span class="token operator">=</span>falseï¼Œ æŒ‡å®šå®¹å™¨æ˜¯å¦ä¸ºç‰¹æƒå®¹å™¨ï¼Œç‰¹æƒå®¹å™¨æ‹¥æœ‰æ‰€æœ‰çš„capabilities
	--restart<span class="token operator">=</span><span class="token string">&quot;no&quot;</span>ï¼Œ æŒ‡å®šå®¹å™¨åœæ­¢åçš„é‡å¯ç­–ç•¥:
	noï¼šå®¹å™¨é€€å‡ºæ—¶ä¸é‡å¯
	on-failureï¼šå®¹å™¨æ•…éšœé€€å‡ºï¼ˆè¿”å›å€¼éé›¶ï¼‰æ—¶é‡å¯
	alwaysï¼šå®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯
	--rm<span class="token operator">=</span>falseï¼Œ æŒ‡å®šå®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨<span class="token punctuation">(</span>ä¸æ”¯æŒä»¥docker run -då¯åŠ¨çš„å®¹å™¨<span class="token punctuation">)</span>
	--sig-proxy<span class="token operator">=</span>trueï¼Œ è®¾ç½®ç”±ä»£ç†æ¥å—å¹¶å¤„ç†ä¿¡å·ï¼Œä½†æ˜¯SIGCHLDã€SIGSTOPå’ŒSIGKILLä¸èƒ½è¢«ä»£ç†
	ç¤ºä¾‹
	è¿è¡Œä¸€ä¸ªåœ¨åå°æ‰§è¡Œçš„å®¹å™¨ï¼ŒåŒæ—¶ï¼Œè¿˜èƒ½ç”¨æ§åˆ¶å°ç®¡ç†ï¼šdocker run -i -t -d ubuntu:latest
	è¿è¡Œä¸€ä¸ªå¸¦å‘½ä»¤åœ¨åå°ä¸æ–­æ‰§è¡Œçš„å®¹å™¨ï¼Œä¸ç›´æ¥å±•ç¤ºå®¹å™¨å†…éƒ¨ä¿¡æ¯ï¼šdocker run -d ubuntu:latest <span class="token function">ping</span> www.docker.com
	è¿è¡Œä¸€ä¸ªåœ¨åå°ä¸æ–­æ‰§è¡Œçš„å®¹å™¨ï¼ŒåŒæ—¶å¸¦æœ‰å‘½ä»¤ï¼Œç¨‹åºè¢«ç»ˆæ­¢åè¿˜èƒ½é‡å¯ç»§ç»­è·‘ï¼Œè¿˜èƒ½ç”¨æ§åˆ¶å°ç®¡ç†ï¼Œdocker run -d --restart<span class="token operator">=</span>always ubuntu:latest <span class="token function">ping</span> www.docker.com
	ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—ï¼Œdocker run -d --name<span class="token operator">=</span>ubuntu_server ubuntu:latest
	å®¹å™¨æš´éœ²80ç«¯å£ï¼Œå¹¶æŒ‡å®šå®¿ä¸»æœº80ç«¯å£ä¸å…¶é€šä¿¡<span class="token punctuation">(</span>: ä¹‹å‰æ˜¯å®¿ä¸»æœºç«¯å£ï¼Œä¹‹åæ˜¯å®¹å™¨éœ€æš´éœ²çš„ç«¯å£<span class="token punctuation">)</span>ï¼Œdocker run -d --name<span class="token operator">=</span>ubuntu_server -p <span class="token number">80</span>:80 ubuntu:latest
	æŒ‡å®šå®¹å™¨å†…ç›®å½•ä¸å®¿ä¸»æœºç›®å½•å…±äº«<span class="token punctuation">(</span>: ä¹‹å‰æ˜¯å®¿ä¸»æœºæ–‡ä»¶å¤¹ï¼Œä¹‹åæ˜¯å®¹å™¨éœ€å…±äº«çš„æ–‡ä»¶å¤¹<span class="token punctuation">)</span>ï¼Œdocker run -d --name<span class="token operator">=</span>ubuntu_server -v /etc/www:/var/www ubuntu:latest
</code></pre></div><h2 id="heroku"><a href="#heroku" class="header-anchor">#</a> Heroku</h2> <blockquote><p>TODO</p></blockquote> <hr> <blockquote><p>æ¬¢è¿å¤§å®¶åˆ°<a href="https://support.qq.com/products/93432/" target="_blank" rel="noopener noreferrer">é²ç­H5-ç¤¾åŒº<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> äº¤æµï¼Œåœ¨è¿™é‡Œå¯ä»¥æé—®ã€åé¦ˆæ„è§å’Œå»ºè®®ï¼Œä¸ä½œè€…ç›´æ¥äº’åŠ¨</p></blockquote> <!----></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ly525/luban-h5/edit/dev/docs/zh/getting-started/deployment.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/4/2019, 1:15:32 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/luban-h5/zh/getting-started/quick-start.html" class="prev">å¿«é€Ÿå¼€å§‹</a></span> <span class="next"><a href="/luban-h5/zh/getting-started/discussion.html">ç¤¾åŒºä¸äº¤æµç¾¤</a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/luban-h5/assets/js/app.9db938e8.js" defer></script><script src="/luban-h5/assets/js/2.45c7802b.js" defer></script><script src="/luban-h5/assets/js/16.a76b2f4d.js" defer></script>
  </body>
</html>
